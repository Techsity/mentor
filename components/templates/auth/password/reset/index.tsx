import React, { FormEvent, useState } from "react";
import { PrimaryButton } from "../../../../ui/atom/buttons";
import ActivityIndicator from "../../../../ui/atom/loader/ActivityIndicator";
import CustomTextInput from "../../../../ui/atom/inputs/CustomTextInput";
import PasswordValidationComponent from "../../../../ui/atom/forms/auth/login-and-signup/signup/PasswordValidationComponent";
import { IResetPasswordState } from "../../../../../interfaces/auth.interface";
import { useRouter } from "next/router";
import { toast } from "react-toastify";
import { ToastDefaultOptions } from "../../../../../constants";
import { randomUUID } from "crypto";

const ResetNewPasswordTemplate = () => {
	const router = useRouter();
	const [loading, setLoading] = useState<boolean>(false);
	const [state, setState] = useState<IResetPasswordState>({
		newPassword: "",
		confirmNewPassword: "",
	});

	const handleSubmit = (e: FormEvent) => {
		setLoading(true);
		e.preventDefault();
		if (state.newPassword && state.confirmNewPassword)
			if (state.newPassword === state.confirmNewPassword)
				//mock loading before proceeding
				setTimeout(function () {
					router.replace(
						`/auth/reset-password/${randomUUID()}?finish`,
					);
				}, 2000);
			else {
				toast.error(
					"Passwords do not match",
					ToastDefaultOptions({ id: "auth_form_pop" }),
				);
			}
		else {
			toast.error(
				"Please enter your passwords",
				ToastDefaultOptions({ id: "auth_form_pop" }),
			);
		}
	};

	return (
		<div className="min-h-[80vh] flex sm:justify-center pt-20 sm:mt-24 md:px-24">
			<ReusableParticles />
			<form className="w-full sm:w-auto" onSubmit={handleSubmit}>
				<h1
					className="sm:text-3xl text-[20px] text-[#00D569] px-5 sm:px-auto"
					style={{ fontFamily: "Days One" }}>
					Now Reset your Password
				</h1>
				<div className="flex gap-5 flex-col justify-start px-5 mt-5">
					<CustomTextInput
						required={true}
						placeholder="New Password"
						type="password"
						className="bg-transparent placeholder:font-[300] placeholder:text-[#A3A6A7] text-sm"
						onChange={(e) =>
							setState({ ...state, newPassword: e.target.value })
						}
						containerProps={{
							className:
								"border border-[#094B10] bg-transparent duration-300 min-h-[45px]",
						}}
					/>
					<CustomTextInput
						required={true}
						placeholder="Confirm New Password"
						type="password"
						className="bg-transparent placeholder:font-[300] placeholder:text-[#A3A6A7] text-sm"
						onChange={(e) =>
							setState({
								...state,
								confirmNewPassword: e.target.value,
							})
						}
						containerProps={{
							className:
								"border border-[#094B10] bg-transparent duration-300 min-h-[45px]",
						}}
					/>
				</div>
				<div className="px-5 sm:px-auto mt-6 grid gap-5">
					<div className="sm:flex grid gap-5 mt-5 items-center">
						<PrimaryButton
							type="submit"
							disabled={loading}
							title={!loading ? "Continue" : ""}
							icon={
								loading ? (
									<div className="flex justify-center">
										<ActivityIndicator />
									</div>
								) : null
							}
							className="px-12 duration-300 p-3 text-center"
						/>
						<div
							className={`flex flex-col items-center sm:items-start font-[300]`}>
							{/* <button
                        onClick={() => setCountdown(timeLimit)} // handleResendOtp
                        className={countdown > 0 ? "cursor-not-allowed" : "font-medium"}
                        disabled={countdown > 0}
                    >
                        Resend OTP {countdown > 0 ? "in" : null}
                    </button>
                    {countdown >= 1 ? (
                        <div className="flex items-center text-[#A3A6A7] gap-1">
                            {countdown}
                            <span className="text-black">sec.</span>
                        </div>
                    ) : null} */}
						</div>
					</div>
					<PasswordValidationComponent password={state.newPassword} />
				</div>
			</form>
		</div>
	);
};
const ReusableParticles = () => {
	return (
		<div className="sm:block hidden">
			<svg
				width="54"
				height="34"
				viewBox="0 0 54 34"
				fill="none"
				className="absolute top-40 left-[23%] animate__headShake animate__infinite animate__slower">
				<path
					d="M53.2473 16.5505C52.9976 13.268 51.9212 10.0384 50.0529 7.31648C48.1976 4.61361 45.5836 1.90227 42.5048 0.630441C41.4889 0.21092 40.588 -0.050837 39.4821 0.265944C38.576 0.52485 37.5977 1.23722 37.159 2.08956C36.1577 4.03023 36.7526 6.28567 38.6173 7.43539C39.1122 7.7403 39.6134 8.03955 40.1012 8.35571C40.3134 8.49335 40.5823 8.63999 40.7733 8.81536C40.8338 8.87465 40.8918 8.93077 40.9265 8.95997C41.3718 9.33803 41.7973 9.73945 42.2 10.1627C42.4017 10.3746 42.5884 10.5988 42.7869 10.8124C42.8273 10.8615 42.8475 10.8861 42.8758 10.9185C42.9357 10.9994 42.9972 11.0794 43.0555 11.1611C43.3931 11.6344 43.7062 12.1264 43.9915 12.633C44.1338 12.8855 44.2688 13.1421 44.3968 13.4027C44.4384 13.4901 44.48 13.5768 44.5223 13.6634C44.7052 14.064 44.6831 14.0139 44.4578 13.5123C44.7639 13.863 44.8872 14.7034 45.0074 15.1478C45.0828 15.4249 45.1494 15.7037 45.2073 15.9842C45.2291 16.0886 45.2461 16.1938 45.2655 16.299C45.2673 16.315 45.269 16.3261 45.2707 16.3437C45.3012 16.9191 45.3459 17.4856 45.3261 18.0631C45.3181 18.2995 45.3564 18.7056 45.266 18.9261L45.3235 18.4432C45.2957 18.6263 45.2632 18.8079 45.2259 18.9895C45.1139 19.536 44.9426 20.0567 44.7714 20.5862C44.7706 20.587 44.7706 20.5886 44.7706 20.5894C44.7589 20.6111 44.7487 20.628 44.7346 20.6544C44.5581 20.9804 44.4025 21.3141 44.2133 21.6338C44.0719 21.8739 43.9113 22.0999 43.7659 22.3369C43.7502 22.3626 43.74 22.3803 43.7274 22.4019C43.7219 22.4076 43.7195 22.4108 43.7132 22.4172C43.3452 22.8369 42.9845 23.2541 42.5787 23.6398C42.5154 23.7003 42.4167 23.8107 42.3131 23.9179C42.1697 24.0279 42.0238 24.1348 41.8763 24.2384C41.3458 24.6102 40.7858 24.908 40.2196 25.2194C40.2053 25.2276 40.1974 25.2324 40.1847 25.239C40.1767 25.2414 40.1711 25.2431 40.1624 25.2464C39.9037 25.332 39.6508 25.4311 39.3897 25.5095C39.1293 25.588 38.8673 25.6568 38.602 25.7154C38.5135 25.7338 38.4251 25.7523 38.3366 25.7707C37.8982 25.8477 37.982 25.8381 38.5879 25.7426C38.5438 25.8852 37.1273 25.8034 36.9603 25.7955C36.8692 25.7892 36.7781 25.7838 36.687 25.7775C36.2434 25.7348 36.3226 25.7451 36.9253 25.8078C36.7443 25.9142 35.9306 25.5925 35.7304 25.5346C35.4678 25.459 35.0679 25.3903 34.8388 25.2384C34.9417 25.3069 35.0148 25.3549 35.0678 25.3903C34.9393 25.3069 34.7327 25.1764 34.6445 25.1334C34.0796 24.8579 33.5343 24.5439 33.0048 24.205C32.738 24.0336 32.4751 23.8557 32.2162 23.6722C32.1559 23.6297 31.9217 23.4476 31.7905 23.3451C31.2754 22.9286 30.7634 22.5104 30.2648 22.0746C25.7205 18.1128 20.9482 13.4714 14.4723 13.5356C10.9226 13.5707 7.75063 15.2295 5.22004 17.6293C3.04464 19.6926 1.00241 22.7071 0.337836 25.6649C0.0747569 26.8357 0.451872 28.0665 1.43717 28.7873C2.31468 29.4294 3.80267 29.7117 4.74969 28.9877C6.92902 27.3212 8.50947 25.0881 10.5257 23.2396C10.593 23.1782 11.012 22.8395 11.1125 22.7467C11.2449 22.6551 11.3964 22.5506 11.4448 22.519C11.682 22.3634 11.9249 22.2156 12.1734 22.079C12.2926 22.014 12.4133 21.9529 12.5325 21.8902C12.8008 21.8141 13.0609 21.7069 13.3325 21.6348C13.3954 21.6182 13.604 21.5618 13.7689 21.517C13.8246 21.5053 13.8796 21.496 13.9116 21.4941C14.1246 21.4824 14.3369 21.4659 14.5501 21.4646C14.7089 21.463 14.8679 21.4678 15.0261 21.475C15.07 21.477 15.2051 21.4924 15.3178 21.5057C15.5043 21.5462 15.7739 21.6018 15.8468 21.6202C16.2102 21.7092 16.5618 21.8247 16.9175 21.9402C16.9792 21.9603 17.0104 21.9688 17.0465 21.9796C17.0802 21.9969 17.1075 22.0118 17.1636 22.04C17.5078 22.2082 17.8505 22.3765 18.1861 22.5616C18.8172 22.9107 19.4262 23.2983 20.0172 23.7125C20.2022 23.8416 20.6182 24.168 20.4588 24.0371C20.7043 24.2335 20.9506 24.4282 21.1921 24.6303C23.5633 26.6134 25.7447 28.7772 28.2769 30.5687C33.412 34.2013 39.9427 34.8209 45.3772 31.4413C50.4118 28.3108 53.7027 22.5403 53.2473 16.5521L53.2473 16.5505Z"
					fill="#FFB100"
				/>
			</svg>
			<svg
				width="43"
				height="41"
				viewBox="0 0 43 41"
				fill="none"
				className="absolute top-40 right-[23%]">
				<path
					d="M40.1144 28.6564C39.0556 26.9467 37.9177 25.2842 36.7064 23.6787C34.1684 20.311 31.4192 17.1453 28.3271 14.2725C25.2517 11.415 21.9005 8.81545 18.3953 6.50688C16.7138 5.39995 14.9823 4.36865 13.2063 3.42065C11.2304 2.36524 8.9945 1.05057 6.81722 0.524161C4.18146 -0.112608 1.49224 1.21549 0.46419 3.72145C-0.590836 6.29286 0.462049 8.96824 2.74498 10.457C4.27953 11.4571 6.13846 12.0795 7.76229 12.9472C9.41056 13.828 11.0209 14.7799 12.5898 15.7973C13.4338 16.3447 14.2658 16.912 15.0848 17.4972C15.4353 17.7478 15.7814 18.0051 16.1298 18.2602C15.0926 17.5026 16.1554 18.2843 16.3825 18.4621C17.9091 19.6612 19.3844 20.927 20.8029 22.2531C22.1689 23.53 23.4814 24.8638 24.737 26.25C25.3636 26.942 25.9848 27.6418 26.5896 28.354C26.868 28.6827 27.1441 29.0136 27.417 29.3479C27.5176 29.4706 27.6161 29.5945 27.7146 29.7172C27.7313 29.7391 27.7369 29.7479 27.7593 29.7753C28.868 31.2857 29.9745 32.785 30.9866 34.3637C31.4905 35.1486 31.9428 35.9739 32.473 36.742C33.4195 37.9401 33.5986 38.1682 33.0101 37.426C33.2842 37.7736 33.5583 38.1211 33.8324 38.4686C34.38 39.0918 35.0856 39.4991 35.7673 39.9509C38.8245 41.9766 42.7079 39.1849 42.7456 35.8536C42.7772 33.1409 41.5011 30.9009 40.1111 28.6564L40.1144 28.6564Z"
					fill="#A6E4CA"
				/>
			</svg>
			<svg
				width="51"
				height="65"
				viewBox="0 0 51 65"
				fill="none"
				className="absolute bottom-[20%] left-[23%]">
				<path
					d="M50.5923 3.44117C50.3759 1.66298 49.1197 -0.0701597 47.1216 0.0385874C45.4304 0.131784 43.4881 1.59781 43.719 3.50928C43.8908 4.92726 43.8908 6.33235 43.777 7.75316C43.7454 7.85771 43.728 8.13166 43.7142 8.21449C43.6578 8.55138 43.5937 8.88765 43.5206 9.22193C43.3564 9.97405 43.1504 10.7169 42.904 11.4469C42.8007 11.7523 42.7184 12.136 42.5515 12.4121C42.985 11.6934 42.4923 12.5364 42.3848 12.7675C42.0603 13.4663 41.6973 14.1474 41.2987 14.8073C40.9747 15.3442 40.6298 15.8883 40.2428 16.3855C40.1254 16.5249 39.951 16.7337 39.885 16.8115C39.6082 17.1374 39.3216 17.4543 39.0251 17.7616C38.5498 18.2555 38.0436 18.7109 37.5283 19.1614C37.5117 19.1755 37.4911 19.1944 37.4683 19.2148C37.3821 19.2796 37.2959 19.3465 37.2124 19.4078C36.8675 19.6606 36.5134 19.9018 36.1522 20.1305C35.5846 20.4899 34.9979 20.8181 34.3991 21.1215C34.1004 21.2724 33.7974 21.4137 33.4945 21.5557C33.4703 21.5671 33.4433 21.5812 33.4164 21.5961C33.2911 21.6467 33.1623 21.6917 33.0418 21.7395C30.3506 22.8036 27.5241 23.4675 24.7055 24.0923C19.0649 25.342 13.0935 26.52 8.40947 30.1306C2.98481 34.3113 -0.156438 41.1532 0.551761 48.0354C0.930137 51.7174 2.21627 55.2806 4.4237 58.269C5.64574 59.9233 7.00102 61.4894 8.67866 62.6965C10.2555 63.8309 12.5585 65.0339 14.4921 64.2253C15.6242 63.7513 16.2058 62.8352 15.9551 61.5876C15.6188 59.9086 14.1596 58.791 12.989 57.6345C12.5258 57.177 12.0386 56.744 11.5837 56.2774C11.3408 56.0282 11.1054 55.7728 10.8763 55.5103C10.7617 55.3794 10.6541 55.2422 10.5388 55.1126C10.5353 55.1085 10.5353 55.1092 10.5318 55.1058C10.524 55.0955 10.5226 55.0927 10.5142 55.0809C10.1056 54.5186 9.71355 53.9485 9.36086 53.3495C9.18486 53.0504 9.01717 52.747 8.85845 52.4387C8.7791 52.2845 8.70182 52.1296 8.6266 51.9726C8.5968 51.9103 8.53817 51.815 8.48243 51.7294C8.5064 51.7646 8.52615 51.7936 8.55929 51.8419C8.2265 51.3581 8.08174 50.5639 7.92192 50.0033C7.73977 49.3637 7.54186 48.6763 7.46574 48.0072C7.45414 47.819 7.43616 47.5468 7.42886 47.4405C7.40382 47.0885 7.3892 46.7356 7.38571 46.3826C7.3829 46.0296 7.38983 45.6765 7.40927 45.324C7.41864 45.1481 7.4308 44.9715 7.44573 44.7956C7.4501 44.7455 7.44947 44.683 7.44746 44.6204C7.44972 44.6378 7.44981 44.6461 7.45208 44.6648C7.38691 44.0491 7.72232 43.1848 7.88392 42.5918C7.96504 42.2936 8.05454 41.9988 8.1517 41.7053C8.20702 41.538 8.26513 41.3713 8.32533 41.2053C8.36996 41.0812 8.41669 40.957 8.4655 40.8342C8.41868 40.948 8.37185 41.061 8.32503 41.1748C8.30598 40.9359 8.66369 40.4278 8.77 40.2169C8.92811 39.9027 9.09599 39.5932 9.27435 39.2898C9.45202 38.9865 9.63947 38.6886 9.83602 38.3976C9.91478 38.2814 10.0287 38.069 10.1382 37.9658C10.0666 38.0332 10.0129 38.0838 9.97365 38.121C10.0652 38.0326 10.2001 37.8999 10.2523 37.8382C10.7 37.3001 11.1856 36.7935 11.7028 36.3214C11.8343 36.2006 12.3606 35.8772 12.4443 35.6977C12.5451 35.6245 12.6458 35.5505 12.7479 35.4786C13.2821 35.105 13.8373 34.7604 14.4068 34.4441C14.6915 34.2857 14.9798 34.1341 15.2716 33.9887C15.4175 33.9164 15.5641 33.8448 15.7122 33.7759C15.7481 33.7589 15.8062 33.727 15.867 33.6931C16.9886 33.0656 18.4356 32.7386 19.6573 32.388C22.3597 31.6121 25.1221 31.0747 27.8601 30.4451C33.7367 29.0944 39.545 27.0932 43.8526 22.6754C48.7141 17.6906 51.4374 10.3992 50.5909 3.44188L50.5923 3.44117Z"
					fill="#A6E4CA"
				/>
			</svg>
			<svg
				width="35"
				height="46"
				viewBox="0 0 35 46"
				fill="none"
				className="absolute bottom-[20%] right-[23%] animate__headShake animate__infinite animate__slower">
				<path
					d="M33.0954 22.065C32.0596 19.8044 30.2746 17.9603 28.1891 16.6324C26.0923 15.2975 23.3574 14.5542 20.8751 14.7711C18.1844 15.0063 15.8499 16.0348 13.4293 17.1705C13.2005 17.278 12.9728 17.3855 12.744 17.4921C12.7188 17.5035 12.6765 17.5231 12.6301 17.5438C12.4838 17.5919 11.6882 17.9116 11.56 17.9533C11.3955 18.0066 11.1458 18.0435 10.9053 18.0925C11.0513 18.1072 11.033 18.2015 10.6948 18.1917C10.6593 18.1911 10.6137 18.1875 10.5681 18.1839C10.552 18.1901 10.5389 18.1973 10.5228 18.2036C10.5197 18.1995 10.5166 18.1945 10.5135 18.1915C10.5186 18.1884 10.5256 18.1843 10.5306 18.1822C10.5225 18.1813 10.5134 18.1804 10.5043 18.1795C10.4848 18.1533 10.4653 18.1292 10.4458 18.098C10.4252 18.0648 10.3943 18.0074 10.3613 17.947C10.3092 17.8038 10.2405 17.6101 10.183 17.4264C10.1846 17.3798 10.187 17.321 10.1901 17.2279C10.1909 17.2056 10.1901 17.1266 10.1882 17.0325C10.202 16.8946 10.2195 16.7153 10.2428 16.6219C10.2798 16.4687 10.3269 16.3194 10.374 16.1711C10.3502 16.2189 10.3969 16.0281 10.4682 15.8644C10.4888 15.7994 10.5104 15.7354 10.529 15.6694C10.5095 15.7405 10.4948 15.7872 10.4791 15.842C10.489 15.8207 10.4989 15.7983 10.5088 15.779C10.7048 15.4268 10.8866 15.0767 11.1019 14.7364C11.2106 14.5642 11.3284 14.399 11.4442 14.2318C11.4722 14.1981 11.4862 14.1808 11.5272 14.1338C12.4022 13.139 13.3265 12.2086 14.3283 11.3401C14.5481 11.1497 14.7761 10.9682 14.9969 10.7767C15.009 10.7664 15.015 10.7603 15.0261 10.7511C15.0753 10.7172 15.1306 10.6772 15.1969 10.6289C15.7901 10.2029 16.3914 9.78996 16.965 9.33882C18.0259 8.50521 18.8493 7.72149 19.2094 6.35926C19.5236 5.17162 19.3612 3.59591 18.6725 2.55185C17.1307 0.212244 14.3421 -0.44452 11.8866 0.844321C9.41596 2.1404 7.10164 4.1902 5.18081 6.20572C3.15476 8.33061 1.47355 10.8256 0.639089 13.6636C-1.04647 19.3964 1.85919 26.3462 7.92802 27.9191C10.6097 28.6134 13.3563 28.0972 15.8587 27.0407C17.0857 26.5224 18.2774 25.9254 19.4993 25.399C19.5467 25.3833 19.5861 25.3698 19.6527 25.3468C19.8888 25.2665 20.1187 25.1731 20.3558 25.0959C20.5899 25.0196 20.8261 24.9485 21.0645 24.8874C21.1715 24.859 21.2806 24.8376 21.3887 24.8143C21.4687 24.8125 21.5578 24.8126 21.6347 24.8129C21.8054 24.874 22.0647 24.8815 22.3059 24.9064C22.4514 24.9759 22.5948 25.0494 22.7343 25.129C22.8891 25.2155 23.0368 25.3133 23.1876 25.407C23.3871 25.6115 23.5986 25.818 23.8091 26.0103C23.9275 26.2086 24.051 26.4098 24.1754 26.5989C24.1846 26.613 24.1867 26.616 24.1949 26.6291C24.2159 26.7018 24.2358 26.7745 24.2537 26.8381C24.2461 26.7855 24.2477 26.747 24.2566 26.7216C24.2781 26.7538 24.2966 26.781 24.3079 26.797C24.3147 26.8719 24.3188 26.9761 24.3219 27.0875C24.4086 27.3559 24.3735 27.2874 24.3223 27.1249C24.3273 27.3203 24.3283 27.5197 24.3278 27.5734C24.3262 27.7212 24.3125 27.8692 24.3038 28.0181C24.2744 28.1145 24.1841 28.7037 24.1472 28.865C23.4823 31.7509 22.1142 34.6772 22.4944 37.7036C22.9286 41.1587 24.6351 44.4929 28.3194 45.32C30.6471 45.8426 33.1732 43.7087 32.3306 41.2285C32.2701 41.0499 32.2298 40.8681 32.1714 40.6905C32.4573 41.5533 32.261 40.8485 32.1471 40.389C32.1408 40.1633 32.1176 39.7566 32.1164 39.6422C32.111 39.1968 32.1238 38.7481 32.1346 38.3026C32.1374 38.178 32.2042 37.6671 32.1672 37.6067C32.1408 37.8084 32.1144 38.0112 32.0881 38.2129C32.1403 37.858 32.1782 37.5013 32.2172 37.1445C32.208 37.1355 32.2067 37.1032 32.2279 36.9997C32.2347 36.9662 32.2404 36.9317 32.2462 36.8983C32.2517 36.8415 32.2613 36.7857 32.2668 36.7289C32.2728 36.7218 32.2738 36.7238 32.2788 36.7177C32.2912 36.6417 32.3046 36.5656 32.3201 36.4905C32.4341 35.9407 32.5897 35.3995 32.7484 34.8613C33.1089 33.6408 33.5343 32.4389 33.8227 31.1979C34.5559 28.0471 34.4417 25.01 33.0903 22.062L33.0954 22.065Z"
					fill="#FFB100"
				/>
			</svg>
		</div>
	);
};

export default ResetNewPasswordTemplate;
